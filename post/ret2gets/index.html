<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Who Needs POP RDI? You Have gets()" />
<meta property="og:locale" content="en" />
<meta name="description" content="Facing a gadget-poor binary? This post reveals how gets() can be your ultimate ROP primitive. By understanding how gets() reuses the existing RDI value from the vulnerable buffer, we can craft precise chains that set up function arguments and leak libc addresses without traditional gadgets." />
<meta property="og:description" content="Facing a gadget-poor binary? This post reveals how gets() can be your ultimate ROP primitive. By understanding how gets() reuses the existing RDI value from the vulnerable buffer, we can craft precise chains that set up function arguments and leak libc addresses without traditional gadgets." />
<link rel="canonical" href="https://tibane0.github.io/post/ret2gets/" />
<meta property="og:url" content="https://tibane0.github.io/post/ret2gets/" />
<meta property="og:site_name" content="tibane" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-26T00:00:00+02:00" />
<meta property="og:image" content="https://tibane0.github.io/assets/images/me.jpeg" /><meta name="twitter:card" content="summary_large_image" />
      <meta property="twitter:image" content="https://tibane0.github.io/assets/images/me.jpeg" />
<meta property="twitter:title" content="Who Needs POP RDI? You Have gets()" />
<meta name="twitter:site" content="@tibane101" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-19T09:19:56+02:00","datePublished":"2025-09-26T00:00:00+02:00","description":"Facing a gadget-poor binary? This post reveals how gets() can be your ultimate ROP primitive. By understanding how gets() reuses the existing RDI value from the vulnerable buffer, we can craft precise chains that set up function arguments and leak libc addresses without traditional gadgets.","headline":"Who Needs POP RDI? You Have gets()","mainEntityOfPage":{"@type":"WebPage","@id":"https://tibane0.github.io/post/ret2gets/"},"url":"https://tibane0.github.io/post/ret2gets/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Who Needs POP `RDI?` You Have `gets()` | tibane
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="tibane">
<meta name="application-name" content="tibane">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/me.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">tibane</a>
    <p class="site-subtitle fst-italic mb-0">Exploring low-level development and the craft of pwning.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/projects/" class="nav-link">
            <i class="fa-fw fas fa-code"></i>
            

            <span>PROJECTS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/resume/" class="nav-link">
            <i class="fa-fw fas fa-id-card"></i>
            

            <span>RESUME</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/tibane0"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/tibane101"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['nkatekotibane101','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/nkatekotibane"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Who Needs POP `RDI?` You Have `gets()`</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Who Needs POP `RDI?` You Have `gets()`</h1>
    
      <p class="post-desc fw-light mb-4">Facing a gadget-poor binary? This post reveals how gets() can be your ultimate ROP primitive. By understanding how gets() reuses the existing RDI value from the vulnerable buffer, we can craft precise chains that set up function arguments and leak libc addresses without traditional gadgets.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1758837600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep 26, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760858396"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 19, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/tibane101">Nkateko Tibane</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="779 words"
>
  <em>4 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Who Needs POP `RDI?` You Have `gets()`</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Who Needs POP `RDI?` You Have `gets()`</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p>Many ROP exploits involves finding a <code class="language-plaintext highlighter-rouge">pop rdi; ret</code> gadget. Since <code class="language-plaintext highlighter-rouge">rdi</code> is used to pass the first argument to functions in the <code class="language-plaintext highlighter-rouge">x86_64</code> calling convention, this gadget is crucial for setting up calls to functions.</p>

<p>In binaries compiled with modern <code class="language-plaintext highlighter-rouge">glibc (2.34 and newer)</code>, this and other useful gadgets are often missing.</p>

<p>Source of the gadget</p>
<ul>
  <li>The gadget was commonly found in the <code class="language-plaintext highlighter-rouge">__libc_csu_init</code> function, which used to be included in most dynamically linked binaries.</li>
  <li>The disassembly of <code class="language-plaintext highlighter-rouge">__libc_csu_init</code> contains the instruction sequence <code class="language-plaintext highlighter-rouge">pop r15; ret</code>. The machine code for this is <code class="language-plaintext highlighter-rouge">41 5f c3</code>. The last two bytes <code class="language-plaintext highlighter-rouge">5f c3</code> of that sequence happen to be the exact machine code for <code class="language-plaintext highlighter-rouge">pop rdi ; ret</code>, therefore if a attacker as the address of  <code class="language-plaintext highlighter-rouge">pop r15; ret</code>, they could add one byte to that address to get <code class="language-plaintext highlighter-rouge">pop rdi; ret</code></li>
</ul>

<p>Why it disappeared.
A patch in <code class="language-plaintext highlighter-rouge">glibc 2.34</code> was introduced to remove useful ROP gadgets for the <code class="language-plaintext highlighter-rouge">ret2csu</code> exploit technique, which had the side effect of no longer compiling the <code class="language-plaintext highlighter-rouge">__libc_csu_init</code> function into binaries.</p>

<hr />
<p>To overcome the lack of <code class="language-plaintext highlighter-rouge">pop rdi; ret</code> gadget a technique known as <code class="language-plaintext highlighter-rouge">ret2gets</code> can be used.</p>

<p>This techniques leverages the behaviour of the <code class="language-plaintext highlighter-rouge">gets()</code> function to control the <code class="language-plaintext highlighter-rouge">rdi</code> register and even leak the base address of libc.</p>

<p>When <code class="language-plaintext highlighter-rouge">gets()</code> finishes reading from <code class="language-plaintext highlighter-rouge">stdin</code>, it often leaves the address of a writable libc structure, <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code>, in the <code class="language-plaintext highlighter-rouge">rdi</code> register before it returns. This behaviour is because of the thread-safe locking mechanism used by glibc’s I/O functions.</p>

<p><code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code> structure.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
   <span class="kt">int</span> <span class="n">lock</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
   <span class="kt">void</span> <span class="o">*</span><span class="n">owner</span><span class="p">;</span>
<span class="p">}</span> <span class="n">_IO_lock_t</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>To prevent race conditions in multi-threaded programs, I/O functions like <code class="language-plaintext highlighter-rouge">gets()</code> must “lock” the file stream they are using. <code class="language-plaintext highlighter-rouge">gets()</code> calls <code class="language-plaintext highlighter-rouge">_IO_acquire_lock</code> at the beginning and <code class="language-plaintext highlighter-rouge">_IO_release_lock</code> at the end. The release macro calls <code class="language-plaintext highlighter-rouge">_IO_lock_unlock</code>, and this function loads the address of the lock structure for <code class="language-plaintext highlighter-rouge">stdin</code> (which is <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code> ) into the <code class="language-plaintext highlighter-rouge">rdi</code> register just before returning, this is done to prepare for a potential call to an underlying system function that expects its argument in <code class="language-plaintext highlighter-rouge">rdi</code>. When <code class="language-plaintext highlighter-rouge">gets()</code> returns, <code class="language-plaintext highlighter-rouge">rdi</code> points to <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code>, a writable location in libc’s memory.</p>

<h2 id="how-to-exploit-this"><span class="me-2">How to exploit this.</span><a href="#how-to-exploit-this" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="writing-to-rdi"><span class="me-2">Writing to <code class="language-plaintext highlighter-rouge">rdi</code></span><a href="#writing-to-rdi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Since <code class="language-plaintext highlighter-rouge">gets()</code> leaves a pointer to a writable memory in <code class="language-plaintext highlighter-rouge">rdi</code>, we can use a second call to <code class="language-plaintext highlighter-rouge">gets()</code> to write data to that location.</p>

<p>The attack goes as follows:</p>
<ol>
  <li>First <code class="language-plaintext highlighter-rouge">gets()</code>:
    <ul>
      <li>The first <code class="language-plaintext highlighter-rouge">gets()</code> is called, whether called in binary or in your <code class="language-plaintext highlighter-rouge">ROP chain</code>. After this call returns, <code class="language-plaintext highlighter-rouge">rdi</code> will contain the address of <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code></li>
    </ul>
  </li>
  <li>Second <code class="language-plaintext highlighter-rouge">gets()</code>:
    <ul>
      <li>Call <code class="language-plaintext highlighter-rouge">gets()</code> again (<code class="language-plaintext highlighter-rouge">gets@plt</code>). This time when gets executes, it will read input from you and write it to the address currently in <code class="language-plaintext highlighter-rouge">rdi</code> (<code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code>).</li>
    </ul>
  </li>
  <li>Payload:
    <ul>
      <li>Send the string you want to populate <code class="language-plaintext highlighter-rouge">rdi</code>. e.g. <code class="language-plaintext highlighter-rouge">/bin/sh</code></li>
    </ul>
  </li>
  <li>Call the function:
    <ul>
      <li>
        <div class="table-wrapper"><table>
          <tbody>
            <tr>
              <td>In <code class="language-plaintext highlighter-rouge">ROP chain</code> follow the second <code class="language-plaintext highlighter-rouge">gets@plt</code> with a call to the function you want to execute (e.g. <code class="language-plaintext highlighter-rouge">system</code></td>
              <td>when system is called <code class="language-plaintext highlighter-rouge">rdi</code> will still point to the <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code>) .</td>
            </tr>
          </tbody>
        </table></div>
      </li>
    </ul>
  </li>
</ol>

<p>Example</p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="n">payload</span> <span class="o">=</span> <span class="nf">flat</span><span class="p">(</span>
	<span class="n">gets_plt</span><span class="p">,</span>
	<span class="n">gets_plt</span><span class="p">,</span>
	<span class="n">system_plt</span>
<span class="p">)</span>
<span class="c1">#
</span><span class="n">binsh</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">/bin</span><span class="sh">"</span> <span class="o">+</span> <span class="nf">p8</span><span class="p">(</span><span class="nf">u8</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="s">sh</span><span class="sh">"</span>
<span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="c1"># get shell
</span></pre></td></tr></tbody></table></code></div></div>

<blockquote>
  <p><strong>Note</strong>: 
The <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code> structure contains a counter field named <code class="language-plaintext highlighter-rouge">cnt</code>. The unlock function decrements this counter, and if it becomes zero, it may ruin you payload. To avoid this, you must overwrite <code class="language-plaintext highlighter-rouge">cnt</code> with a value other than 1 as part of your string that is placed in <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code>.</p>
</blockquote>

<h3 id="leaking-the-libc-base-address"><span class="me-2">Leaking the Libc base address</span><a href="#leaking-the-libc-base-address" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <code class="language-plaintext highlighter-rouge">_IO_stdfile_0_lock</code>  structure also contains the field named <code class="language-plaintext highlighter-rouge">owner</code>, which points to the Thread Local Storage (<code class="language-plaintext highlighter-rouge">TLS</code>) for the current thread. The <code class="language-plaintext highlighter-rouge">TLS</code> address has a predictable offset from the libc base address, so leaking the owner pointer allows you to calculate the base address of libc.</p>

<h4 id="method-1"><span class="me-2">Method 1</span><a href="#method-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>If the binary called <code class="language-plaintext highlighter-rouge">printf</code> function we can use that to leak addresses and find libc base address (<code class="language-plaintext highlighter-rouge">format string vulnerabiliity</code>)</p>

<p>Example</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="n">payload</span> <span class="o">=</span> <span class="nf">flat</span><span class="p">(</span>
	<span class="nf">cyclic</span><span class="p">(</span><span class="n">padding_to_ret</span><span class="p">),</span>
	<span class="n">elf</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="sh">'</span><span class="s">gets</span><span class="sh">'</span><span class="p">],</span>
	<span class="n">elf</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="sh">'</span><span class="s">printf</span><span class="sh">'</span><span class="p">],</span>
	<span class="n">elf</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">main</span><span class="sh">'</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">fmt_str</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%p</span><span class="sh">"</span><span class="o">*</span><span class="mi">3</span> <span class="c1"># "%3%p"
</span><span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">fmt_str</span><span class="p">)</span>
<span class="n">leaked_bytes</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
<span class="n">leaked_addr</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">leaked_bytes</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">lib</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">leaked_addr</span>  <span class="o">-</span> <span class="n">offset</span> <span class="c1"># where offset 
</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="method-2"><span class="me-2">Method 2</span><a href="#method-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>This works for <code class="language-plaintext highlighter-rouge">glibc 2.30 - 2.36</code></p>
<ol>
  <li>First <code class="language-plaintext highlighter-rouge">gets()</code>:</li>
  <li>Send a payload that sets the <code class="language-plaintext highlighter-rouge">cnt</code> field to 0</li>
  <li>When the unlock function runs, it first decrements <code class="language-plaintext highlighter-rouge">cnt</code>, which undeflows from 0 to 0xffffffff, then the check to see if <code class="language-plaintext highlighter-rouge">cnt</code> is zero fails.</li>
  <li>Because the check fails, the owner field is not cleared, and the null byte from <code class="language-plaintext highlighter-rouge">gets()</code> is written after the <code class="language-plaintext highlighter-rouge">TLS</code> pointer allowing a call to <code class="language-plaintext highlighter-rouge">puts()</code>/<code class="language-plaintext highlighter-rouge">printf</code> to leak the address.</li>
</ol>

<hr />
<h2 id="reference"><span class="me-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="https://sashactf.gitbook.io/pwn-notes/pwn/rop-2.34+/ret2gets#exploit-techniques">ret2gets</a></p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/notes/">notes</a>,
          <a href="/categories/rop/">rop</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ret2gets/"
            class="post-tag no-text-decoration"
          >ret2gets</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Who%20Needs%20POP%20%60RDI?%60%20You%20Have%20%60gets()%60%20-%20tibane&url=https%3A%2F%2Ftibane0.github.io%2Fpost%2Fret2gets%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Who%20Needs%20POP%20%60RDI?%60%20You%20Have%20%60gets()%60%20-%20tibane&u=https%3A%2F%2Ftibane0.github.io%2Fpost%2Fret2gets%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Ftibane0.github.io%2Fpost%2Fret2gets%2F&text=Who%20Needs%20POP%20%60RDI?%60%20You%20Have%20%60gets()%60%20-%20tibane" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/unlink-exploit/">Unlink Exploit</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/qnqsec-debtors-database/">QNQSEC Debtor's Database Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/information-leaks/">Information Disclosure</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/Fastbin-dup/">Fastbin Exploitation</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/post/srop/">Sigreturn Oriented Programming</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fastbin-dup/">fastbin-dup</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fastbin/">fastbin</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/gambling/">gambling</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/heap-exploitation/">heap-exploitation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/info-leak/">info-leak</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/protostar-stack/">protostar-stack</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pwn-env/">pwn-env</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ret2gets/">ret2gets</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/srop/">srop</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/stack-canary/">stack-canary</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/post/srop/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760306400"
  data-df="ll"
  
>
  Oct 13, 2025
</time>

              <h4 class="pt-0 my-2">Sigreturn Oriented Programming</h4>
              <div class="text-muted">
                <p>Sigreturn Oriented Programming.  SROP (Sigreturn Oriented Programming) is binary exploitation technique that leverages the signal handling mechanisms in POSIX systems to gain control over CPU regis...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/post/UDA/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760047200"
  data-df="ll"
  
>
  Oct 10, 2025
</time>

              <h4 class="pt-0 my-2">Uninitialized Data Access</h4>
              <div class="text-muted">
                <p>Overview  So what are Uninitialized variables? Uninitialized variables are variables that are declared byt they are not assigned a value  e.g.  1 2 3 4 5 6 7 8 9 #include &amp;lt;stdio.h&amp;gt;  // compli...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/post/Fastbin-dup/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1759615200"
  data-df="ll"
  
>
  Oct  5, 2025
</time>

              <h4 class="pt-0 my-2">Fastbin Exploitation</h4>
              <div class="text-muted">
                <p>Explanation of the `fastbin dup` heap exploitation technique</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/post/tcache-poisioning/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Tcache Poisioning</p>
    </a>
  

  
    <a
      href="/post/information-leaks/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Information Disclosure</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/tibane101">Nkateko Tibane</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fastbin-dup/">fastbin-dup</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fastbin/">fastbin</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/gambling/">gambling</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/heap-exploitation/">heap-exploitation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/info-leak/">info-leak</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/protostar-stack/">protostar-stack</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pwn-env/">pwn-env</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ret2gets/">ret2gets</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/srop/">srop</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/stack-canary/">stack-canary</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script>
  (function () {
    const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed');
    const initTheme = themeMapper[Theme.visualState];

    let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) {
      lang = lang.slice(0, 2);
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'tibane0/tibane0.github.io',
      'data-repo-id': 'R_kgDOOv_aMg',
      'data-category': 'General',
      'data-category-id': 'DIC_kwDOOv_aMs4CqjgI',
      'data-mapping': 'pathname',
      'data-strict' : '0',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': lang,
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusNode = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusNode.setAttribute(key, value)
    );

    const $footer = document.querySelector('footer');
    $footer.insertAdjacentElement("beforebegin", giscusNode);

    addEventListener('message', (event) => {
      if (event.source === window && event.data && event.data.id === Theme.ID) {
        const newTheme = themeMapper[Theme.visualState];

        const message = {
          setConfig: {
            theme: newTheme
          }
        };

        const giscus =
          document.getElementsByClassName('giscus-frame')[0].contentWindow;
        giscus.postMessage({ giscus: message }, 'https://giscus.app');
      }
    });
  })();
</script>



    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

